<Window x:Class="IPTVApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vlc="clr-namespace:LibVLCSharp.WPF;assembly=LibVLCSharp.WPF"
        xmlns:services="clr-namespace:IPTVApp.Services"
        
        mc:Ignorable="d"
        Title="Püsü IPTV" Height="600" Width="800"
        Icon="Resources/Images/logo.jpg"
        WindowStartupLocation="CenterScreen"
        PreviewKeyDown="Window_KeyDown"
        FontFamily="./Resources/Fonts/#Canada, Segoe UI Variable Display, Segoe UI, Roboto, Helvetica, Arial">
    <Window.Resources>
        <services:CountryToFlagConverter x:Key="CountryToFlagConverter"/>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <SolidColorBrush x:Key="FF8C42_Brush" Color="#FF8C42"/>
        <!-- Modern Context Menu Style -->
        <Style x:Key="ModernContextMenu" TargetType="ContextMenu">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ContextMenu">
                        <Border Background="#E61A1A1A" BorderBrush="#FF8C42" BorderThickness="1" CornerRadius="10" Padding="5">
                             <Border.Effect>
                                <DropShadowEffect Color="Black" BlurRadius="15" ShadowDepth="2" Opacity="0.6"/>
                             </Border.Effect>
                             <ItemsPresenter Margin="0" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ModernMenuItem" TargetType="MenuItem">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="MenuItem">
                        <Border x:Name="Border" Background="Transparent" CornerRadius="6" Margin="2">
                            <Grid>
                                <ContentPresenter ContentSource="Header" Margin="{TemplateBinding Padding}" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#33FF8C42"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Modern Slider Style -->
        <Style x:Key="ModernSliderStyle" TargetType="Slider">
            <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Slider">
                        <Grid Background="Transparent" VerticalAlignment="Center" Height="30">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*" MinWidth="{TemplateBinding MinWidth}" MaxWidth="{TemplateBinding MaxWidth}"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Border x:Name="TrackBackground" Grid.Column="1" Height="2" Background="#55FFFFFF" CornerRadius="1" VerticalAlignment="Center" Margin="5,0"/>
                            <Canvas Grid.Column="1" Height="2" VerticalAlignment="Center" Margin="5,0">
                                <Border x:Name="PART_SelectionRange" Height="2" Background="#00A8E8" CornerRadius="1"/>
                            </Canvas>
                            <Track x:Name="PART_Track" Grid.Column="1">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.DecreaseLarge}" Background="Transparent" BorderThickness="0" Height="4"/>
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static Slider.IncreaseLarge}" Background="Transparent" BorderThickness="0" Height="4"/>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Width="12" Height="12" VerticalAlignment="Center" Background="White">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Ellipse Fill="White" Width="12" Height="12"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Modern ScrollBar Style -->
        <Style x:Key="ModernScrollBarStyle" TargetType="ScrollBar">
            <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
            <Setter Property="Foreground" Value="#444"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid x:Name="GridRoot" Width="8" Background="{TemplateBinding Background}">
                            <Track x:Name="PART_Track" IsDirectionReversed="true" Focusable="false">
                                <Track.Thumb>
                                    <Thumb x:Name="Thumb" Background="#555" Style="{DynamicResource ScrollThumbStyle}"/>
                                </Track.Thumb>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="ScrollBar.PageDownCommand" Opacity="0" Focusable="false"/>
                                </Track.IncreaseRepeatButton>
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="ScrollBar.PageUpCommand" Opacity="0" Focusable="false"/>
                                </Track.DecreaseRepeatButton>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ScrollThumbStyle" TargetType="{x:Type Thumb}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Rectangle x:Name="rectangle" Fill="#555" RadiusX="4" RadiusY="4"/>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="rectangle" Property="Fill" Value="#888"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Modern ComboBox Style -->
        <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="ToggleButton">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="20"/>
                </Grid.ColumnDefinitions>
                <Border x:Name="Border" Grid.ColumnSpan="2" CornerRadius="8" Background="#33FFFFFF" BorderBrush="Transparent" BorderThickness="0"/>
                <Border Grid.Column="0" CornerRadius="8,0,0,8" Margin="1" Background="Transparent"/>
                <Path x:Name="Arrow" Grid.Column="1" Fill="#BBB" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M0,0 L0,2 L4,6 L8,2 L8,0 L4,4 z"/>
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="true">
                    <Setter TargetName="Border" Property="Background" Value="#4DFFFFFF"/> <!-- ~30% white -->
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="#33FFFFFF"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="Background" Value="#1E1E1E"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Foreground" Value="White"/>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton Name="ToggleButton" Template="{StaticResource ComboBoxToggleButton}" Grid.Column="2" Focusable="false" IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press"/>
                            <ContentPresenter Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Margin="10,3,23,3" VerticalAlignment="Center" HorizontalAlignment="Left"/>
                            <Popup Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                <Grid Name="DropDown" SnapsToDevicePixels="True" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder" Background="#1E1E1E" BorderThickness="1" BorderBrush="#333" CornerRadius="8"/>
                                    <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Rounded Search Box Style -->
        <Style x:Key="ModernSearchBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#33FFFFFF"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="30,5,5,5"/> <!-- Left padding for icon space -->
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Grid>
                            <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="10" BorderThickness="0"/>
                            <!-- Icon -->
                            <TextBlock Text="??" Foreground="#888" Margin="8,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Left" FontSize="12"/>
                            <!-- Text Content -->
                            <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                            <!-- Placeholder -->
                            <TextBlock Text="Search channels..." Foreground="#666" Margin="30,0,0,0" VerticalAlignment="Center" IsHitTestVisible="False">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="border" Property="Background" Value="#333"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="true">
                                <Setter TargetName="border" Property="Background" Value="#444"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Gradient Button Style -->
        <Style x:Key="GradientButtonStyle" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" CornerRadius="12">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#6C63FF" Offset="0.0"/>
                                    <GradientStop Color="#00A8E8" Offset="1.0"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.7"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Tab Button Style -->
        <Style x:Key="TabButtonStyle" TargetType="RadioButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#888"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="15" Padding="0,8">
                            <TextBlock Text="{TemplateBinding Content}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#10FFFFFF"/> <!-- Light glass -->
                                <Setter Property="Foreground" Value="White"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Trigger>
                                            <TextBlock Text="(Kullanıcı Adı/Şifre)" FontSize="12" Foreground="#666" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Modern Text Box Style (General) -->
        <Style x:Key="ModernTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#262626"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8" BorderThickness="0">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="border" Property="Background" Value="#333"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="true">
                                <Setter TargetName="border" Property="Background" Value="#444"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Modern Password Box Style -->
        <Style x:Key="ModernPasswordBoxStyle" TargetType="PasswordBox">
            <Setter Property="Background" Value="#262626"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="PasswordBox">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8" BorderThickness="0">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="border" Property="Background" Value="#333"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="true">
                                <Setter TargetName="border" Property="Background" Value="#444"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Tile Button Style (for Type Selection) -->
        <Style x:Key="TileButtonStyle" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#30FFFFFF"/>
            <Setter Property="Margin" Value="15"/>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="#1AFFFFFF" CornerRadius="20" Padding="20" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <Border.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                            </Border.RenderTransform>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <EventTrigger RoutedEvent="MouseEnter">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.08" Duration="0:0:0.25"/>
                                        <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.08" Duration="0:0:0.25"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <EventTrigger RoutedEvent="MouseLeave">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.0" Duration="0:0:0.25"/>
                                        <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.0" Duration="0:0:0.25"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#25FFFFFF"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#6C63FF"/>
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect Color="#6C63FF" BlurRadius="30" ShadowDepth="0" Opacity="0.5"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Modern Back Button Style -->
        <Style x:Key="ModernBackButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#888"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="20">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="White"/>
                                <Setter TargetName="border" Property="Background" Value="#20FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#30FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Sidebar List Item Style -->
        <Style x:Key="SidebarItemStyle" TargetType="ListBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#DDDDDD"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Margin" Value="0,4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#3A3A3A"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#1000A8E8"/> <!-- Slight tint -->
                                <Setter TargetName="Bd" Property="BorderBrush" Value="#00A8E8"/>
                                <Setter TargetName="Bd" Property="BorderThickness" Value="1"/>
                                <Setter Property="Foreground" Value="#00A8E8"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!-- Page Fade & Slide Animation -->
        <Storyboard x:Key="FadeInAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.4"/>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" From="20" To="0" Duration="0:0:0.4">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Key="FadeInSlideUpStoryboard">
            <DoubleAnimation Storyboard.TargetName="InfoBorder" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.4"/>
            <DoubleAnimation Storyboard.TargetName="InfoBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" To="0" Duration="0:0:0.4">
                <DoubleAnimation.EasingFunction>
                    <CircleEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Key="FadeOutSlideDownStoryboard">
            <DoubleAnimation Storyboard.TargetName="InfoBorder" Storyboard.TargetProperty="Opacity" From="1" To="0" Duration="0:0:0.8"/>
            <DoubleAnimation Storyboard.TargetName="InfoBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" To="50" Duration="0:0:0.8"/>
        </Storyboard>
    </Window.Resources>
    <Grid Background="#121212"> <!-- Main Window Dark Background -->
        <!-- Welcome Screen -->
        <Grid x:Name="WelcomeScreen" Visibility="Visible">
            <Grid.RenderTransform>
                <TranslateTransform Y="0"/>
            </Grid.RenderTransform>
            <Grid.Background>
                <RadialGradientBrush Center="0.5,0.2" GradientOrigin="0.5,0.2" RadiusX="1" RadiusY="1">
                    <GradientStop Color="#251B2E" Offset="0"/>
                    <GradientStop Color="#121212" Offset="1"/>
                </RadialGradientBrush>
            </Grid.Background>
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <!-- Branding / Logo Area -->
                <Image Source="Resources/Images/logo_full.jpg" Width="300" Height="300" Margin="0,0,0,30" HorizontalAlignment="Center"/>
                <!-- Two Large Options -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <!-- Option 1: M3U File -->
                    <Button x:Name="BtnLoadM3uWelcome" Width="300" Height="200" Click="BtnLoadM3uWelcome_Click" Margin="0,0,20,0" RenderTransformOrigin="0.5,0.5">
                         <Button.RenderTransform>
                            <ScaleTransform ScaleX="1" ScaleY="1"/>
                         </Button.RenderTransform>
                         <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border" Background="#1E1E1E" CornerRadius="20" Padding="20" RenderTransformOrigin="0.5,0.5">
                                    <Border.RenderTransform>
                                        <ScaleTransform ScaleX="1" ScaleY="1"/>
                                    </Border.RenderTransform>
                                    <Viewbox> <!-- Auto scale content -->
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <TextBlock Text="??" FontSize="50" HorizontalAlignment="Center" Margin="0,0,0,10" Foreground="#6C63FF"/>
                                            <TextBlock Text="M3U Listesi Yükle" FontSize="20" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                            <TextBlock x:Name="TxtM3uPath" Text="(Dosya Seç)" FontSize="12" Foreground="#666" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                        </StackPanel>
                                    </Viewbox>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <EventTrigger RoutedEvent="MouseEnter">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.05" Duration="0:0:0.2"/>
                                                <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.05" Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <EventTrigger RoutedEvent="MouseLeave">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.0" Duration="0:0:0.2"/>
                                                <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.0" Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#252525"/>
                                        <Setter TargetName="border" Property="Effect">
                                            <Setter.Value>
                                                <DropShadowEffect Color="#6C63FF" BlurRadius="30" ShadowDepth="0" Opacity="0.5"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                         </Button.Template>
                    </Button>
                    <!-- Option 2: Xtream Codes -->
                    <Button x:Name="BtnServerLogin" Width="300" Height="200" Click="BtnServerLogin_Click" RenderTransformOrigin="0.5,0.5">
                         <Button.RenderTransform>
                            <ScaleTransform ScaleX="1" ScaleY="1"/>
                         </Button.RenderTransform>
                         <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border" Background="#1E1E1E" CornerRadius="20" Padding="20" RenderTransformOrigin="0.5,0.5">
                                    <Border.RenderTransform>
                                        <ScaleTransform ScaleX="1" ScaleY="1"/>
                                    </Border.RenderTransform>
                                    <Viewbox>
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <TextBlock Text="??" FontSize="50" HorizontalAlignment="Center" Margin="0,0,0,10" Foreground="#00A8E8"/>
                                            <TextBlock Text="Xtream Kod Girişi" FontSize="20" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                            <TextBlock Text="(Kullanıcı Adı/Şifre)" FontSize="12" Foreground="#666" HorizontalAlignment="Center" Margin="0,5,0,0"/>
                                        </StackPanel>
                                    </Viewbox>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <EventTrigger RoutedEvent="MouseEnter">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.05" Duration="0:0:0.2"/>
                                                <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.05" Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <EventTrigger RoutedEvent="MouseLeave">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.0" Duration="0:0:0.2"/>
                                                <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.0" Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#252525"/>
                                         <Setter TargetName="border" Property="Effect">
                                            <Setter.Value>
                                                <DropShadowEffect Color="#00A8E8" BlurRadius="30" ShadowDepth="0" Opacity="0.5"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                         </Button.Template>
                    </Button>
                </StackPanel>
            </StackPanel>
            <!-- Bottom Right Buttons -->
            <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="20">
                <Button x:Name="BtnHowToUse" Style="{StaticResource ModernBackButtonStyle}" 
                        Click="BtnHowToUse_Click" Margin="0,0,15,0" Width="140" Height="40">
                    <TextBlock Text="Nasıl Kullanılır?" FontSize="14" FontWeight="SemiBold"/>
                </Button>
                <Button x:Name="BtnAbout" Style="{StaticResource ModernBackButtonStyle}" 
                        Click="BtnAbout_Click" Width="100" Height="40">
                    <TextBlock Text="Hakkında" FontSize="14" FontWeight="SemiBold"/>
                </Button>
            </StackPanel>
        </Grid>
        <!-- Server Login Screen -->
        <Grid x:Name="ServerLoginScreen" Visibility="Collapsed">
            <Grid.RenderTransform>
                <TranslateTransform Y="0"/>
            </Grid.RenderTransform>
            <Grid.Background>
                <RadialGradientBrush Center="0.5,0.2" GradientOrigin="0.5,0.2" RadiusX="1" RadiusY="1">
                    <GradientStop Color="#1B252E" Offset="0"/>
                    <GradientStop Color="#121212" Offset="1"/>
                </RadialGradientBrush>
            </Grid.Background>
            
            <!-- Two Column Layout -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                <!-- Left: Login Form -->
                <Border Background="#1E1E1E" Width="400" CornerRadius="20" Padding="35" Margin="0,0,20,0">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="40" ShadowDepth="10" Opacity="0.5"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="? Yeni Hesap" FontSize="24" FontWeight="Bold" Foreground="#4CAF50" HorizontalAlignment="Left" Margin="0,0,0,25"/>
                        
                        <TextBlock Text="Hesap Adı" FontSize="12" FontWeight="Bold" Foreground="#CCC" Margin="0,0,0,8"/>
                        <TextBox x:Name="TxtAccountName" Height="40" Style="{StaticResource ModernTextBoxStyle}" Margin="0,0,0,15"/>
                        
                        <TextBlock Text="Sunucu URL" FontSize="12" FontWeight="Bold" Foreground="#CCC" Margin="0,0,0,8"/>
                        <TextBox x:Name="TxtServerUrl" Height="40" Style="{StaticResource ModernTextBoxStyle}" Margin="0,0,0,15" Text="http://"/>
                        
                        <TextBlock Text="Kullanıcı Adı" FontSize="12" FontWeight="Bold" Foreground="#CCC" Margin="0,0,0,8"/>
                        <TextBox x:Name="TxtUsername" Height="40" Style="{StaticResource ModernTextBoxStyle}" Margin="0,0,0,15"/>
                        
                        <TextBlock Text="Şifre" FontSize="12" FontWeight="Bold" Foreground="#CCC" Margin="0,0,0,8"/>
                        <PasswordBox x:Name="TxtPassword" Height="40" Style="{StaticResource ModernPasswordBoxStyle}" Margin="0,0,0,25"/>
                        
                        <Button Content="? Kaydet" Height="45" Style="{StaticResource GradientButtonStyle}" Click="BtnConnectServer_Click"/>
                    </StackPanel>
                </Border>
                
                <!-- Right: Saved Accounts -->
                <Border Background="#1E1E1E" Width="350" CornerRadius="20" Padding="25">
                    <Border.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="40" ShadowDepth="10" Opacity="0.5"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                            <TextBlock Text="??" FontSize="20" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBlock Text="Kayıtlı Hesaplar" FontSize="20" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <ListBox x:Name="SavedAccountsListBox" Grid.Row="1" Background="Transparent" BorderThickness="0"
                                 MouseDoubleClick="SavedAccountsListBox_MouseDoubleClick">
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="ListBoxItem">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ListBoxItem">
                                                <Border x:Name="AccountBorder" Background="#2A2A2A" CornerRadius="12" Margin="0,0,0,10" Padding="15" Cursor="Hand">
                                                    <Border.ContextMenu>
                                                        <ContextMenu Style="{StaticResource ModernContextMenu}">
                                                            <MenuItem Header="?? Düzenle" Click="EditAccount_Click" CommandParameter="{Binding}" Foreground="#FF8C42" FontWeight="SemiBold"/>
                                                            <MenuItem Header="??? Sil" Click="DeleteAccount_Click" CommandParameter="{Binding}" Foreground="#FF8C42" FontWeight="SemiBold"/>
                                                        </ContextMenu>
                                                    </Border.ContextMenu>
                                                    <StackPanel VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding AccountName}" Foreground="White" FontSize="16" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                                        <TextBlock Text="{Binding ServerUrl}" Foreground="#888" FontSize="11" TextTrimming="CharacterEllipsis" Margin="0,3,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="AccountBorder" Property="Background" Value="#3A3A3A"/>
                                                    </Trigger>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter TargetName="AccountBorder" Property="Background" Value="#1A6C63FF"/>
                                                        <Setter TargetName="AccountBorder" Property="BorderBrush" Value="#6C63FF"/>
                                                        <Setter TargetName="AccountBorder" Property="BorderThickness" Value="1"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </ListBox.ItemContainerStyle>
                        </ListBox>
                        
                        <!-- Empty State -->
                        <TextBlock x:Name="TxtNoAccounts" Grid.Row="1" Text="Henüz kayıtlı hesap yok" 
                                   Foreground="#666" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center"
                                   Visibility="Collapsed"/>
                    </Grid>
                </Border>
            </StackPanel>
            
            <Button Style="{StaticResource ModernBackButtonStyle}" Click="BtnBackToWelcome_Click" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="20" Width="40" Height="40" FontSize="18">
                <TextBlock Text="&#xE72B;" FontFamily="Segoe MDL2 Assets"/>
            </Button>
        </Grid>
        <!-- STAGE 2: Type Selection Screen -->
        <Grid x:Name="TypeSelectionScreen" Visibility="Collapsed">
            <Grid.RenderTransform>
                <TranslateTransform Y="0"/>
            </Grid.RenderTransform>
            <Grid.Background>
                <RadialGradientBrush Center="0.5,0.5" GradientOrigin="0.5,0.5" RadiusX="1" RadiusY="1">
                    <GradientStop Color="#1E1E2E" Offset="0"/>
                    <GradientStop Color="#121212" Offset="1"/>
                </RadialGradientBrush>
            </Grid.Background>
            <Button Click="BtnBackToWelcome_Click" Style="{StaticResource ModernBackButtonStyle}" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="20" Width="40" Height="40" FontSize="18">
                <TextBlock Text="&#xE72B;" FontFamily="Segoe MDL2 Assets"/>
            </Button>
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,50">
                    <Image Source="Resources/Images/puskul_head.png" Width="60" Height="60" Margin="0,0,10,0" VerticalAlignment="Center" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
                    <TextBlock Text="Püskül neyi izlemek istiyor?" FontSize="32" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>
                <UniformGrid Columns="4" HorizontalAlignment="Center">
                    <!-- TV Button -->
                    <Button Style="{StaticResource TileButtonStyle}" Width="220" Height="220" Click="TypeSelect_Click" Tag="TV" Margin="15">
                        <StackPanel>
                            <TextBlock Text="??" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                            <TextBlock Text="CANLI TV" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                        </StackPanel>
                    </Button>
                    <!-- Film Button -->
                    <Button Style="{StaticResource TileButtonStyle}" Width="220" Height="220" Click="TypeSelect_Click" Tag="Movie" Margin="15">
                        <StackPanel>
                            <TextBlock Text="??" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                            <TextBlock Text="FİLMLER" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                        </StackPanel>
                    </Button>
                    <!-- Dizi Button -->
                    <Button Style="{StaticResource TileButtonStyle}" Width="220" Height="220" Click="TypeSelect_Click" Tag="Series" Margin="15">
                        <StackPanel>
                            <TextBlock Text="??" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,15">
                                <TextBlock.RenderTransform>
                                    <RotateTransform Angle="15"/>
                                </TextBlock.RenderTransform>
                            </TextBlock>
                            <TextBlock Text="DİZİLER" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center" Foreground="White"/>
                        </StackPanel>
                    </Button>
                    <!-- Püskül's Favorites Button -->
                    <Button Style="{StaticResource TileButtonStyle}" Width="220" Height="220" Click="TypeSelect_Click" Tag="Favorites" Margin="15">
                        <StackPanel>
                            <TextBlock Text="??" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                            <TextBlock Text="PÜSKÜL'ÜN" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#FF8C42"/>
                            <TextBlock Text="FAVORİLERİ" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#FF8C42"/>
                        </StackPanel>
                    </Button>
                </UniformGrid>
            </StackPanel>
        </Grid>
        <!-- Main Content Screen (Split Layout) -->
        <Grid x:Name="MainContentScreen" Visibility="Collapsed">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <!-- Sidebar (Left) -->
            <Border x:Name="SidebarBorder" Grid.Column="0" Background="#CC1E1E1E" Padding="15">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/> <!-- Header & Back -->
                        <RowDefinition Height="Auto"/> <!-- Category Filter -->
                        <RowDefinition Height="Auto"/> <!-- Search -->
                        <RowDefinition Height="*"/>    <!-- List -->
                    </Grid.RowDefinitions>
                    <!-- Row 0: Header & Back -->
                    <Grid Grid.Row="0" Margin="0,0,0,15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/> <!-- New Row for Logo Status -->
                        </Grid.RowDefinitions>
                        <Button Grid.Row="0" Click="BtnBackToType_Click" Style="{StaticResource ModernBackButtonStyle}" 
                                HorizontalAlignment="Left" Margin="0,0,0,10" Width="40" Height="40" FontSize="18">
                            <TextBlock Text="&#xE72B;" FontFamily="Segoe MDL2 Assets"/>
                        </Button>
                        <Grid Grid.Row="1">
                            <TextBlock x:Name="TxtSelectedType" Text="Kanal Listesi" FontSize="20" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                            <TextBlock x:Name="TxtClock" Text="00:00" FontSize="20" FontWeight="Light" Foreground="White" HorizontalAlignment="Right" VerticalAlignment="Center" Opacity="0.8"/>
                        </Grid>
                        <!-- Logo Update Progress (Moved to Row 2) -->
                        <StackPanel Grid.Row="2" x:Name="LogoProgressPanel" Orientation="Horizontal" Visibility="Collapsed" Margin="0,5,0,0" HorizontalAlignment="Left">
                            <TextBlock Text="??" FontSize="16" Foreground="#FF8C42" VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5">
                                <TextBlock.RenderTransform>
                                    <RotateTransform x:Name="PawRotate" Angle="0"/>
                                </TextBlock.RenderTransform>
                                <TextBlock.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetName="PawRotate" Storyboard.TargetProperty="Angle" From="0" To="360" Duration="0:0:2" RepeatBehavior="Forever"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </TextBlock.Triggers>
                            </TextBlock>
                            <TextBlock x:Name="TxtLogoStatus" Text="Püskül logoları tazeliyor..." FontSize="12" Foreground="#FF8C42" VerticalAlignment="Center" Margin="5,0,0,0"/>
                        </StackPanel>
                    </Grid>
                    <!-- Row 1: Removed Country Filter -->
                    <!-- Row 2: Category Filter -->
                    <ComboBox x:Name="CategoryComboBox" Grid.Row="1" Margin="0,0,0,10"
                              Style="{StaticResource ModernComboBoxStyle}"
                              SelectionChanged="CategoryComboBox_SelectionChanged"/>
                    <!-- Row 3: Search -->
                    <Border Grid.Row="3" Background="#33FFFFFF" CornerRadius="8" Margin="0,0,0,15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="??" VerticalAlignment="Center" Margin="10,0,5,0" Foreground="#88FFFFFF"/>
                            <TextBox x:Name="SearchTextBox" Grid.Column="1" Background="Transparent" BorderThickness="0" 
                                     Foreground="White" Padding="5" VerticalAlignment="Center"
                                     TextChanged="SearchTextBox_TextChanged">
                                <TextBox.Resources>
                                    <Style TargetType="{x:Type Border}">
                                        <Setter Property="CornerRadius" Value="8"/>
                                    </Style>
                                </TextBox.Resources>
                            </TextBox> 
                        </Grid>
                    </Border>
                    <!-- Row 4: Channel List -->
                    <ListBox x:Name="ChannelsListBox" Grid.Row="4" Background="Transparent" BorderThickness="0"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             SelectionChanged="ChannelsListBox_SelectionChanged"
                             MouseDoubleClick="ChannelsListBox_MouseDoubleClick"
                             AllowDrop="True" Drop="ChannelsListBox_Drop" DragOver="ChannelsListBox_DragOver"
                             PreviewMouseLeftButtonDown="ChannelsListBox_PreviewMouseLeftButtonDown"
                             PreviewMouseMove="ChannelsListBox_PreviewMouseMove"
                             PreviewMouseLeftButtonUp="ChannelsListBox_PreviewMouseLeftButtonUp">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListBoxItem">
                                            <Border x:Name="ItemBorder" Background="#1AFFFFFF" CornerRadius="8" Margin="0,0,0,8" Padding="10" Cursor="Hand">
                                                <Border.ContextMenu>
                                                    <ContextMenu Style="{StaticResource ModernContextMenu}">
                                                        <MenuItem Header="?? Püskül'ün Favorilerine Ekle/Çıkar" Click="ToggleFavorite_Click" Style="{StaticResource ModernMenuItem}"/>
                                                        <Separator Background="#33FFFFFF" Margin="0,5"/>
                                                        <MenuItem Header="?? Logoyu Güncelle (Püsü Service)" Click="UpdateLogo_Click" Style="{StaticResource ModernMenuItem}"/>
                                                    </ContextMenu>
                                                </Border.ContextMenu>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/> <!-- Logo -->
                                                        <ColumnDefinition Width="*"/>    <!-- Info -->
                                                        <ColumnDefinition Width="Auto"/> <!-- Paw Icon -->
                                                    </Grid.ColumnDefinitions>
                                                    <!-- Logo -->
                                                    <Image Grid.Column="0" Source="{Binding LogoUrl}" Width="40" Height="40" Margin="0,0,10,0" VerticalAlignment="Center" RenderOptions.BitmapScalingMode="Fant"/>
                                                    <!-- Info -->
                                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding Title}" Foreground="White" FontWeight="SemiBold" FontSize="14" TextTrimming="CharacterEllipsis"/>
                                                    </StackPanel>
                                                    <!-- Paw Icon (if favorite) -->
                                                    <TextBlock Grid.Column="2" Text="??" FontSize="18" VerticalAlignment="Center" Margin="10,0,0,0" 
                                                               Visibility="{Binding IsFavorite, Converter={StaticResource BoolToVis}}"/>
                                                </Grid>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="ItemBorder" Property="Background" Value="#33FFFFFF"/>
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="ItemBorder" Property="Background" Value="#3498DB"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListBox.ItemContainerStyle>
                    </ListBox>
                    <!-- Row 5: Clock Removed -->
                </Grid>
            </Border>
            <!-- Video Area (Right) -->
            <Grid Grid.Column="1" Background="Black">
                 <Grid.RowDefinitions>
                     <RowDefinition Height="*"/>
                     <RowDefinition Height="Auto"/>
                 </Grid.RowDefinitions>
                 <!-- Video Player Container (Replaces VideoView) -->
                 <Grid x:Name="PlayerContainer" Grid.Row="0" Background="Black"
                       MouseMove="VideoArea_MouseMove" 
                       MouseWheel="VideoArea_MouseWheel"
                       MouseDown="VideoView_MouseDown">
                     
                     <!-- Duo-View Grid (1x2 Split) -->
                 </Grid>
                 
                 <!-- Püskül Kısık Gözler Uyarısı (Sağ Üst) -->
                 <Border x:Name="PuskulWarningPanel" Grid.Row="0" HorizontalAlignment="Right" VerticalAlignment="Top" 
                         Margin="0,20,20,0" Visibility="Collapsed" MaxWidth="350">
                     <Border Background="#E6FF6B00" CornerRadius="12" Padding="15" BorderBrush="#FF8C42" BorderThickness="2">
                         <Border.Effect>
                             <DropShadowEffect Color="#FF8C42" BlurRadius="15" ShadowDepth="0" Opacity="0.5"/>
                         </Border.Effect>
                         <Grid>
                             <Grid.ColumnDefinitions>
                                 <ColumnDefinition Width="Auto"/>
                                 <ColumnDefinition Width="*"/>
                             </Grid.ColumnDefinitions>
                             <!-- Kısık Gözler -->
                             <TextBlock Grid.Column="0" Text="??" FontSize="40" VerticalAlignment="Center" Margin="0,0,12,0"/>
                             <!-- Uyarı Mesajı -->
                             <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                 <TextBlock Text="Püskül yayını yakalamakta zorlanıyor!" FontWeight="Bold" FontSize="13" 
                                           Foreground="White" TextWrapping="Wrap"/>
                                 <TextBlock x:Name="TxtPuskulWarning" Text="İnternet hızın bu kanal için biraz yavaş kalıyor." 
                                           FontSize="11" Foreground="#FFE0E0E0" TextWrapping="Wrap" Margin="0,5,0,8"/>
                                 <Button x:Name="BtnLowerQuality" Content="?? Daha düşük kalitede dene" 
                                         Click="BtnLowerQuality_Click" Cursor="Hand"
                                         Background="#CC000000" Foreground="White" FontSize="11" FontWeight="SemiBold"
                                         Padding="10,6" BorderThickness="0">
                                     <Button.Style>
                                         <Style TargetType="Button">
                                             <Setter Property="Template">
                                                 <Setter.Value>
                                                     <ControlTemplate TargetType="Button">
                                                         <Border Background="{TemplateBinding Background}" CornerRadius="6">
                                                             <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                         </Border>
                                                     </ControlTemplate>
                                                 </Setter.Value>
                                             </Setter>
                                         </Style>
                                     </Button.Style>
                                 </Button>
                             </StackPanel>
                         </Grid>
                     </Border>
                 </Border>
                 

                 
                 <!-- Information Band (Bottom Layout) -->
                 <!-- Placed in Row 1 to avoid Airspace/Z-Order issues with HwndHost -->
                 <Popup x:Name="InfoPopup" Placement="Relative" PlacementTarget="{Binding ElementName=PlayerContainer}" 
                        AllowsTransparency="True" StaysOpen="True" IsOpen="False">
                     <Border x:Name="InfoBorder" Background="#CC1E1E1E" Padding="15" Width="{Binding ElementName=PlayerContainer, Path=ActualWidth}">
                         <Grid>
                              <Grid.RowDefinitions>
                                  <RowDefinition Height="Auto"/> <!-- Seekbar Row -->
                                  <RowDefinition Height="Auto"/> <!-- Controls Row -->
                              </Grid.RowDefinitions>
                              <!-- Seekbar Row -->
                              <Grid Grid.Row="0" Margin="0,0,0,10" x:Name="SeekbarContainer">
                                  <Grid.ColumnDefinitions>
                                      <ColumnDefinition Width="Auto"/> <!-- Current Time -->
                                      <ColumnDefinition Width="*"/>    <!-- Slider -->
                                      <ColumnDefinition Width="Auto"/> <!-- Total Time -->
                                  </Grid.ColumnDefinitions>
                                  <TextBlock x:Name="TxtCurrentTime" Text="00:00:00" Foreground="White" Opacity="0.8" FontSize="11" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                  <Slider x:Name="TimelineSlider" Grid.Column="1" VerticalAlignment="Center"
                                          Minimum="0" Maximum="1" Value="0" Cursor="Hand"
                                          PreviewMouseLeftButtonDown="TimelineSlider_PreviewMouseLeftButtonDown"
                                          PreviewMouseLeftButtonUp="TimelineSlider_PreviewMouseLeftButtonUp"
                                          ValueChanged="TimelineSlider_ValueChanged">
                                      <Slider.Style>
                                          <Style TargetType="Slider">
                                              <Setter Property="Template">
                                                  <Setter.Value>
                                                      <ControlTemplate TargetType="Slider">
                                                          <Grid Background="Transparent" Height="15">
                                                              <Border x:Name="TrackBackground" Height="4" Background="#33FFFFFF" CornerRadius="2" VerticalAlignment="Center"/>
                                                              <Track x:Name="PART_Track">
                                                                  <Track.DecreaseRepeatButton>
                                                                      <RepeatButton Command="{x:Static Slider.DecreaseLarge}">
                                                                          <RepeatButton.Template>
                                                                              <ControlTemplate TargetType="RepeatButton">
                                                                                  <Border Height="4" Background="#2E7D32" CornerRadius="2" VerticalAlignment="Center"/>
                                                                              </ControlTemplate>
                                                                          </RepeatButton.Template>
                                                                      </RepeatButton>
                                                                  </Track.DecreaseRepeatButton>
                                                                  <Track.Thumb>
                                                                      <Thumb Width="12" Height="12" VerticalAlignment="Center">
                                                                          <Thumb.Template>
                                                                              <ControlTemplate TargetType="Thumb">
                                                                                  <Grid>
                                                                                      <Ellipse Fill="White">
                                                                                          <Ellipse.Effect>
                                                                                              <BlurEffect Radius="2"/>
                                                                                          </Ellipse.Effect>
                                                                                      </Ellipse>
                                                                                      <Ellipse Fill="White" Margin="2"/>
                                                                                  </Grid>
                                                                              </ControlTemplate>
                                                                          </Thumb.Template>
                                                                      </Thumb>
                                                                  </Track.Thumb>
                                                              </Track>
                                                          </Grid>
                                                      </ControlTemplate>
                                                  </Setter.Value>
                                              </Setter>
                                          </Style>
                                      </Slider.Style>
                                  </Slider>
                                  <TextBlock x:Name="TxtTotalTime" Grid.Column="2" Text="00:00:00" Foreground="White" Opacity="0.8" FontSize="11" VerticalAlignment="Center" Margin="10,0,0,0"/>
                              </Grid>
                              <Grid Grid.Row="1">
                                  <Grid.ColumnDefinitions>
                                      <ColumnDefinition Width="*"/>    <!-- Left: Logo + Info -->
                                      <ColumnDefinition Width="Auto"/> <!-- Center: Controls -->
                                      <ColumnDefinition Width="*"/>    <!-- Right: Volume + Clock -->
                                  </Grid.ColumnDefinitions>
                             <!-- Left Section -->
                              <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                                  <Image x:Name="ChannelLogo" Width="50" Height="50" Margin="0,0,15,0" Stretch="Uniform"/>
                                  <StackPanel VerticalAlignment="Center" Margin="0,0,15,0">
                                      <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                                          <!-- Top Row: Channel Name + Stats -->
                                          <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                              <TextBlock x:Name="TxtChannelName" Text="Kanal" Foreground="White" FontSize="20" FontWeight="Bold" VerticalAlignment="Center"/>
                                              <Border x:Name="LiveBadge" Background="#CC2E7D32" CornerRadius="4" Margin="10,0,0,0" Padding="6,2" VerticalAlignment="Center" Visibility="Collapsed">
                                                  <Border.Style>
                                                      <Style TargetType="Border">
                                                          <Style.Triggers>
                                                              <Trigger Property="Visibility" Value="Visible">
                                                                  <Trigger.EnterActions>
                                                                      <BeginStoryboard Name="PulseStory">
                                                                          <Storyboard RepeatBehavior="Forever">
                                                                              <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1.0" To="0.2" Duration="0:0:0.8" AutoReverse="True"/>
                                                                          </Storyboard>
                                                                      </BeginStoryboard>
                                                                  </Trigger.EnterActions>
                                                                  <Trigger.ExitActions>
                                                                      <StopStoryboard BeginStoryboardName="PulseStory"/>
                                                                  </Trigger.ExitActions>
                                                              </Trigger>
                                                          </Style.Triggers>
                                                      </Style>
                                                  </Border.Style>
                                                  <TextBlock x:Name="TxtLiveBadgeText" Text="CANLI" Foreground="White" FontSize="10" FontWeight="Bold" VerticalAlignment="Center"/>
                                              </Border>
                                              
                                              <!-- Inline Stats -->
                                              <StackPanel Orientation="Horizontal" Margin="15,0,0,0" VerticalAlignment="Center">
                                                  <TextBlock x:Name="TxtInlineResolution" Text="-- x --" Foreground="White" FontSize="11" FontWeight="SemiBold" 
                                                             VerticalAlignment="Center" Margin="0,0,10,0" ToolTip="Yayın Çözünürlüğü"/>
                                                  
                                                  <TextBlock x:Name="TxtInlineFps" Text="-- fps" Foreground="White" FontSize="11" FontWeight="SemiBold" 
                                                             VerticalAlignment="Center" Margin="0,0,10,0" ToolTip="Kare Hızı (FPS)"/>
                                                  
                                                  <TextBlock x:Name="TxtInlineBitrate" Text="-- Mbps" Foreground="White" FontSize="11" FontWeight="Bold" 
                                                             VerticalAlignment="Center" Margin="0,0,10,0" ToolTip="Yayın Bit Hızı (Bitrate)"/>
                                                  
                                                  <TextBlock x:Name="TxtInlinePing" Text="-- ms" Foreground="White" FontSize="11" FontWeight="Bold" 
                                                             VerticalAlignment="Center" Margin="0,0,0,0" ToolTip="Gecikme Süresi (Ping)"/>
                                              </StackPanel>
                                          </StackPanel>
                                          
                                          <!-- Bottom Row: Quality Bar -->
                                              <Grid x:Name="QualityBarGrid" Height="4" Margin="0,4,0,0" HorizontalAlignment="Stretch" ToolTip="Yayın Kalitesi Seviyesi">
                                                  <Grid.ColumnDefinitions>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                      <ColumnDefinition Width="*"/>
                                                  </Grid.ColumnDefinitions>
                                                  <Border Background="#333" CornerRadius="2"/>
                                                  <Border x:Name="InlineQualityBar" Grid.ColumnSpan="1" Background="Transparent" CornerRadius="2"/>
                                              </Grid>
                                      </StackPanel>
                                      <TextBlock x:Name="TxtEpg" Text="..." Foreground="#AAAAAA" FontSize="14" Margin="0,2,0,0" Visibility="Collapsed"/>
                                  </StackPanel>
                              </StackPanel>
                             <!-- Center Section (Controls) -->
                             <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                 <Button x:Name="BtnPrevious" Content="&#xE892;" Click="BtnPrevious_Click" 
                                         Width="50" Height="50" FontSize="20" Margin="0,0,15,0" ToolTip="Önceki Kanal"
                                         Background="#00BFA5" BorderThickness="0" Foreground="White" FontWeight="Bold" FontFamily="Segoe MDL2 Assets">
                                     <Button.Style>
                                         <Style TargetType="Button">
                                             <Setter Property="Template">
                                                 <Setter.Value>
                                                     <ControlTemplate TargetType="Button">
                                                         <Border Background="{TemplateBinding Background}" CornerRadius="25">
                                                             <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                         </Border>
                                                     </ControlTemplate>
                                                 </Setter.Value>
                                             </Setter>
                                         </Style>
                                     </Button.Style>
                                 </Button>
                                 <Button x:Name="BtnPause" Content="&#xE769;" Click="BtnPause_Click" 
                                         Width="50" Height="50" FontSize="20" Margin="0,0,15,0" ToolTip="Durdur/Oynat"
                                         Background="#00BFA5" BorderThickness="0" Foreground="White" FontWeight="Bold" FontFamily="Segoe MDL2 Assets">
                                     <Button.Style>
                                         <Style TargetType="Button">
                                             <Setter Property="Template">
                                                 <Setter.Value>
                                                     <ControlTemplate TargetType="Button">
                                                         <Border Background="{TemplateBinding Background}" CornerRadius="25">
                                                             <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                         </Border>
                                                     </ControlTemplate>
                                                 </Setter.Value>
                                             </Setter>
                                         </Style>
                                     </Button.Style>
                                 </Button>
                                 <Button x:Name="BtnNext" Content="&#xE893;" Click="BtnNext_Click" 
                                         Width="50" Height="50" FontSize="20" Margin="0,0,0,0" ToolTip="Sonraki Kanal"
                                         Background="#00BFA5" BorderThickness="0" Foreground="White" FontWeight="Bold" FontFamily="Segoe MDL2 Assets">
                                     <Button.Style>
                                         <Style TargetType="Button">
                                             <Setter Property="Template">
                                                 <Setter.Value>
                                                     <ControlTemplate TargetType="Button">
                                                         <Border Background="{TemplateBinding Background}" CornerRadius="25">
                                                             <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                         </Border>
                                                     </ControlTemplate>
                                                 </Setter.Value>
                                             </Setter>
                                         </Style>
                                     </Button.Style>
                                 </Button>
                              </StackPanel>
                             <!-- Right Section -->
                             <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                                 <!-- Record Button -->
                                 <Button x:Name="BtnRecord" Width="30" Height="30" Margin="0,0,10,0" Background="Transparent" BorderThickness="0" Cursor="Hand" Click="BtnRecord_Click" ToolTip="Yayını Kaydet">
                                     <Button.Template>
                                         <ControlTemplate TargetType="Button">
                                             <Grid>
                                                 <Border x:Name="BtnBorder" Background="Transparent" CornerRadius="15" Width="30" Height="30">
                                                     <Ellipse x:Name="RecordDot" Width="12" Height="12" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                         <Ellipse.Fill>
                                                             <SolidColorBrush x:Name="RecordDotBrush" Color="#D32F2F"/>
                                                         </Ellipse.Fill>
                                                         <Ellipse.Effect>
                                                             <DropShadowEffect Color="#D32F2F" BlurRadius="5" ShadowDepth="0" Opacity="0.6"/>
                                                         </Ellipse.Effect>
                                                     </Ellipse>
                                                 </Border>
                                             </Grid>
                                             <ControlTemplate.Triggers>
                                                 <Trigger Property="IsMouseOver" Value="True">
                                                     <Setter TargetName="RecordDot" Property="Opacity" Value="0.8"/>
                                                 </Trigger>
                                                 <Trigger Property="IsPressed" Value="True">
                                                     <Setter TargetName="RecordDot" Property="Width" Value="10"/>
                                                     <Setter TargetName="RecordDot" Property="Height" Value="10"/>
                                                 </Trigger>
                                             </ControlTemplate.Triggers>
                                         </ControlTemplate>
                                     </Button.Template>
                                 </Button>
                                 <!-- Screenshot Button -->
                                 <Button x:Name="BtnScreenshot" Width="30" Height="30" Margin="0,0,15,0" Background="Transparent" BorderThickness="0" Cursor="Hand" Click="BtnScreenshot_Click" ToolTip="Ekran Görüntüsü">
                                     <Button.Template>
                                         <ControlTemplate TargetType="Button">
                                             <Grid>
                                                 <Border x:Name="ScreenshotBorder" Background="Transparent" CornerRadius="15" Width="30" Height="30">
                                                     <Ellipse x:Name="ScreenshotDot" Width="12" Height="12" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                         <Ellipse.Fill>
                                                             <SolidColorBrush x:Name="ScreenshotDotBrush" Color="#2196F3"/>
                                                         </Ellipse.Fill>
                                                         <Ellipse.Effect>
                                                             <DropShadowEffect Color="#2196F3" BlurRadius="5" ShadowDepth="0" Opacity="0.6"/>
                                                         </Ellipse.Effect>
                                                     </Ellipse>
                                                 </Border>
                                             </Grid>
                                             <ControlTemplate.Triggers>
                                                 <Trigger Property="IsMouseOver" Value="True">
                                                     <Setter TargetName="ScreenshotDot" Property="Opacity" Value="0.8"/>
                                                 </Trigger>
                                                 <Trigger Property="IsPressed" Value="True">
                                                     <Setter TargetName="ScreenshotDot" Property="Width" Value="10"/>
                                                     <Setter TargetName="ScreenshotDot" Property="Height" Value="10"/>
                                                 </Trigger>
                                             </ControlTemplate.Triggers>
                                         </ControlTemplate>
                                     </Button.Template>
                                 </Button>
                                 <!-- Volume Icon (Click to Mute) -->
                                 <TextBlock x:Name="TxtVolumeIcon" Text="&#xE995;" FontFamily="Segoe MDL2 Assets" Foreground="White" 
                                            VerticalAlignment="Center" FontSize="16" Margin="0,0,5,0" Opacity="0.9" Cursor="Hand"
                                            MouseDown="TxtVolumeIcon_MouseDown"/>
                                 <!-- Volume Slider -->
                                 <Slider x:Name="VolumeSlider" Width="100" VerticalAlignment="Center" Minimum="0" Maximum="100" Value="100" 
                                         ValueChanged="VolumeSlider_ValueChanged" Cursor="Hand" IsMoveToPointEnabled="True">
                                     <Slider.Style>
                                         <Style TargetType="Slider">
                                             <Setter Property="Template">
                                                 <Setter.Value>
                                                     <ControlTemplate TargetType="Slider">
                                                         <Grid Background="Transparent" Height="30"> <!-- Taller hit area -->
                                                             <Border x:Name="TrackBackground" Height="4" Background="#33FFFFFF" CornerRadius="2" VerticalAlignment="Center"/>
                                                             <Track x:Name="PART_Track">
                                                                 <Track.DecreaseRepeatButton>
                                                                     <RepeatButton Command="{x:Static Slider.DecreaseLarge}">
                                                                         <RepeatButton.Template>
                                                                             <ControlTemplate TargetType="RepeatButton">
                                                                                 <Border Height="4" Background="#2E7D32" CornerRadius="2" VerticalAlignment="Center"/>
                                                                             </ControlTemplate>
                                                                         </RepeatButton.Template>
                                                                     </RepeatButton>
                                                                 </Track.DecreaseRepeatButton>
                                                                 <Track.Thumb>
                                                                     <Thumb Width="12" Height="12" VerticalAlignment="Center">
                                                                         <Thumb.Template>
                                                                             <ControlTemplate TargetType="Thumb">
                                                                                 <Grid>
                                                                                     <Ellipse Fill="White">
                                                                                         <Ellipse.Effect>
                                                                                             <BlurEffect Radius="2"/>
                                                                                         </Ellipse.Effect>
                                                                                     </Ellipse>
                                                                                     <Ellipse Fill="White" Margin="2"/>
                                                                                 </Grid>
                                                                             </ControlTemplate>
                                                                         </Thumb.Template>
                                                                     </Thumb>
                                                                 </Track.Thumb>
                                                             </Track>
                                                         </Grid>
                                                     </ControlTemplate>
                                                 </Setter.Value>
                                             </Setter>
                                             <Style.Triggers>
                                                 <EventTrigger RoutedEvent="MouseEnter">
                                                     <BeginStoryboard>
                                                         <Storyboard>
                                                             <DoubleAnimation Storyboard.TargetProperty="Width" To="120" Duration="0:0:0.2"/>
                                                         </Storyboard>
                                                     </BeginStoryboard>
                                                 </EventTrigger>
                                                 <EventTrigger RoutedEvent="MouseLeave">
                                                     <BeginStoryboard>
                                                         <Storyboard>
                                                             <DoubleAnimation Storyboard.TargetProperty="Width" To="100" Duration="0:0:0.2"/>
                                                         </Storyboard>
                                                     </BeginStoryboard>
                                                 </EventTrigger>
                                             </Style.Triggers>
                                         </Style>
                                     </Slider.Style>
                                 </Slider>
                                 <!-- Percentage Text -->
                                 <TextBlock x:Name="TxtVolumePercent" Text="%100" Foreground="White" FontSize="12" 
                                            VerticalAlignment="Center" Margin="8,0,0,0" Opacity="0.8" Width="35"/>
                                 <Button x:Name="BtnFullscreen" Content="?" Click="BtnFullscreen_Click" 
                                         Style="{StaticResource ModernBackButtonStyle}" Width="40" Height="40" FontSize="20" Margin="10,0,0,0"/>
                                  <Button x:Name="BtnSettings" Content="?" Click="BtnSettings_Click" 
                                          Style="{StaticResource ModernBackButtonStyle}" Width="40" Height="40" FontSize="20" Margin="10,0,0,0" ToolTip="Seçenekler"/>
                              </StackPanel>
                          </Grid>
                     </Grid>
                       </Border>
                  </Popup>
             </Grid>
         </Grid>
         <!-- Settings Panel -->
         <Popup x:Name="SettingsPopup" Placement="Relative" PlacementTarget="{Binding ElementName=PlayerContainer}" 
                AllowsTransparency="True" StaysOpen="False" PopupAnimation="Slide">
             <Border x:Name="SettingsPanel" Background="#E61E1E2E" CornerRadius="0" Width="300">
                 <Border.Effect>
                     <DropShadowEffect Color="Black" BlurRadius="40" ShadowDepth="0" Opacity="0.5"/>
                 </Border.Effect>
                 <Grid Margin="25">
                     <Grid.RowDefinitions>
                         <RowDefinition Height="Auto"/>
                         <RowDefinition Height="*"/>
                         <RowDefinition Height="Auto"/>
                     </Grid.RowDefinitions>
                     <!-- Header -->
                     <StackPanel Grid.Row="0" Margin="0,0,0,20">
                         <Grid>
                              <TextBlock Text="Seçenekler" FontSize="28" FontWeight="Bold" Foreground="White"/>
                             <Button Click="CloseSettings_Click" HorizontalAlignment="Right" VerticalAlignment="Center" 
                                     Style="{StaticResource ModernBackButtonStyle}" Width="35" Height="35" FontSize="16">
                                 <TextBlock Text="?"/>
                             </Button>
                         </Grid>
                         <Border Height="1" Background="#33FFFFFF" Margin="0,15,0,0"/>
                     </StackPanel>
                     <!-- Content -->
                     <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,0,-15,0" Padding="0,0,15,0">
                         <StackPanel>
                             <!-- Appearance Section -->
                             <TextBlock Text="GENEL AYARLAR" FontSize="12" FontWeight="Bold" Foreground="#88FFFFFF" Margin="0,0,0,15"/>
                             <Border Background="#1AFFFFFF" CornerRadius="12" Padding="15" Margin="0,0,0,20">
                                 <StackPanel>
                                     <Grid Margin="0,0,0,10">
                                         <TextBlock Text="Bilgi Paneli" Foreground="White" VerticalAlignment="Center"/>
                                         <TextBlock Text="Dinamik" Foreground="#00A8E8" HorizontalAlignment="Right" VerticalAlignment="Center" FontSize="12"/>
                                     </Grid>
                                     <Grid>
                                         <TextBlock Text="Uygulama Teması" Foreground="White" VerticalAlignment="Center"/>
                                         <TextBlock Text="Püskül Moru" Foreground="#00A8E8" HorizontalAlignment="Right" VerticalAlignment="Center" FontSize="12"/>
                                     </Grid>
                                 </StackPanel>
                             </Border>
                             <!-- Media Section -->
                             <TextBlock Text="MEDYA AYARLARI" FontSize="12" FontWeight="Bold" Foreground="#88FFFFFF" Margin="0,0,0,15"/>
                             <Border Background="#1AFFFFFF" CornerRadius="12" Padding="15" Margin="0,0,0,20">
                                 <StackPanel>
                                     <TextBlock Text="Ses Kanalı" Foreground="#88FFFFFF" FontSize="11" Margin="0,0,0,5"/>
                                     <ComboBox x:Name="AudioTracksList" Style="{StaticResource ModernComboBoxStyle}" 
                                               SelectionChanged="AudioTrack_Selected" Margin="0,0,0,15" Height="35">
                                         <ComboBox.ItemTemplate>
                                             <DataTemplate>
                                                 <TextBlock Text="{Binding Name}"/>
                                             </DataTemplate>
                                         </ComboBox.ItemTemplate>
                                     </ComboBox>
                                     <TextBlock Text="Altyazı" Foreground="#88FFFFFF" FontSize="11" Margin="0,0,0,5"/>
                                     <ComboBox x:Name="SubtitleTracksList" Style="{StaticResource ModernComboBoxStyle}" 
                                               SelectionChanged="SubtitleTrack_Selected" Margin="0,0,0,10" Height="35">
                                         <ComboBox.ItemTemplate>
                                             <DataTemplate>
                                                 <TextBlock Text="{Binding Name}"/>
                                             </DataTemplate>
                                         </ComboBox.ItemTemplate>
                                     </ComboBox>
                                     <!-- Subtitle Delay Controls -->
                                     <Grid Margin="0,5,0,0">
                                         <TextBlock Text="Altyazı Gecikmesi" Foreground="#88FFFFFF" FontSize="11" VerticalAlignment="Center"/>
                                         <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                             <Button Click="DecreaseSubDelay_Click" Content="-" Width="30" Height="30" 
                                                     Style="{StaticResource ModernBackButtonStyle}" FontSize="18"/>
                                             <TextBlock x:Name="TxtSubDelay" Text="0 ms" Foreground="White" Width="60" 
                                                        TextAlignment="Center" VerticalAlignment="Center" FontSize="12"/>
                                             <Button Click="IncreaseSubDelay_Click" Content="+" Width="30" Height="30" 
                                                     Style="{StaticResource ModernBackButtonStyle}" FontSize="18"/>
                                         </StackPanel>
                                     </Grid>
                                 </StackPanel>
                             </Border>
                             <!-- System Section -->
                             <TextBlock Text="SİSTEM" FontSize="12" FontWeight="Bold" Foreground="#88FFFFFF" Margin="0,0,0,15"/>
                              <Border Background="#1AFFFFFF" CornerRadius="12" Padding="15" Margin="0,0,0,20">
                                  <StackPanel>
                                      <Grid Margin="0,0,0,10">
                                          <TextBlock Text="Donanım Hızlandırma" Foreground="White" VerticalAlignment="Center"/>
                                          <TextBlock Text="Açık" Foreground="#2E7D32" HorizontalAlignment="Right" VerticalAlignment="Center" FontSize="12" FontWeight="Bold"/>
                                      </Grid>
                                      <Grid>
                                          <TextBlock Text="Yönlendirme" Foreground="White" VerticalAlignment="Center"/>
                                          <TextBlock Text="VLC Engine" Foreground="#00A8E8" HorizontalAlignment="Right" VerticalAlignment="Center" FontSize="12"/>
                                      </Grid>
                                  </StackPanel>
                              </Border>


                             <!-- Info Section -->
                             <TextBlock Text="BİLGİ" FontSize="12" FontWeight="Bold" Foreground="#88FFFFFF" Margin="0,0,0,15"/>
                             <Border Background="#1AFFFFFF" CornerRadius="12" Padding="15">
                                 <StackPanel>
                                     <TextBlock Text="Versiyon 1.0.0" Foreground="#AAA" FontSize="12" Margin="0,0,0,5"/>
                                     <TextBlock Text="© 2026 Püsü Media" Foreground="#AAA" FontSize="12"/>
                                 </StackPanel>
                             </Border>
                         </StackPanel>
                     </ScrollViewer>
                     <!-- Footer -->
                     <Border Grid.Row="2" Margin="0,20,0,0" Padding="0,15,0,0" BorderBrush="#33FFFFFF" BorderThickness="0,1,0,0">
                         <TextBlock Text="Püskül sizi seviyor! ??" Foreground="#FF8C42" FontSize="14" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                     </Border>
                 </Grid>
             </Border>
         </Popup>
         <!-- About Screen -->
        <Grid x:Name="AboutScreen" Visibility="Collapsed">
            <Grid.Background>
                <RadialGradientBrush Center="0.5,0.2" GradientOrigin="0.5,0.2" RadiusX="1" RadiusY="1">
                    <GradientStop Color="#121212" Offset="1"/>
                </RadialGradientBrush>
            </Grid.Background>
            <Grid Margin="60">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <TextBlock Text="Püsü IPTV Hakkında" FontSize="48" FontWeight="Bold" Foreground="White" Margin="0,0,0,40"/>
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel MaxWidth="1000" HorizontalAlignment="Left" Margin="0,0,0,40">
                        <TextBlock TextWrapping="Wrap" Foreground="#EEE" FontSize="18" LineHeight="30">
                            <Run Text="Püsü IPTV, sıradan bir medya oynatıcının ötesinde, kullanıcı odaklı tasarımı ve yüksek performansı bir araya getiren modern bir eğlence merkezidir. Adını ve ilhamını evimizin neşesi, turuncu sarman dostumuz Püskül'den alan bu uygulama, 2026 yılının teknolojik standartlarını tamamen Türkçe bir arayüzle buluşturuyor."/>
                            <LineBreak/><LineBreak/>
                            <Span FontWeight="Bold" Foreground="White" FontSize="24">?? Püsü IPTV’yi Özel Kılanlar</Span>
                            <LineBreak/>
                            <Run Text="• Pati İzinde Akıllı Filtreleme: Tür, Ülke ve Konu bazlı 4 aşamalı arama motoruyla aradığınız kanala saniyeler içinde 'zıplayın'."/>
                            <LineBreak/><LineBreak/>
                            <Run Text="• Modern Tasarım: Göz yormayan 'Glassmorphism' temalı şık ve şeffaf bilgi bandı."/>
                            <LineBreak/><LineBreak/>
                            <Run Text="• Dinamik Kategori Yönetimi: Binlerce kanalı karmaşadan uzak tutan; Tür, Ülke ve Konu bazlı gelişmiş hiyerarşi sistemi."/>
                            <LineBreak/><LineBreak/>
                            <Run Text="• Gerçek Tam Ekran Deneyimi: Windows görev çubuğuna takılmayan, minimalist kontrol paneliyle kesintisiz sinematik izleme modu."/>
                            <LineBreak/><LineBreak/>
                            <Run Text="• Hızlı Kanal Geçişi: Kanal geçişlerini milisaniyelere indiren ve donmaları engelleyen optimize edilmiş yayın altyapısı."/>
                            <LineBreak/><LineBreak/>
                            <Span FontWeight="Bold" Foreground="White" FontSize="24">??? Teknik Altyapı ve Vizyon</Span>
                            <LineBreak/>
                            <Run Text="Püsü IPTV, gücünü modern C# ve WPF mimarisinden alırken, görüntü kalitesini dünya standartlarındaki LibVLCSharp altyapısıyla sunar. Uygulama, her açılışta güncel M3U listelerini kontrol eden akıllı bir veri motoruna ve düşük kaynak tüketimiyle çalışan akıcı animasyon sistemine sahiptir."/>
                            <LineBreak/><LineBreak/>
                            <Italic Foreground="#BBB" FontSize="16">Geliştirici Notu: Bu uygulama, karmaşık kanal listelerini düzenli bir kütüphaneye dönüştürerek televizyon izleme alışkanlığınızı yeniden tanımlamak için geliştirilmiştir.</Italic>
                            <LineBreak/><LineBreak/>
                            <Span FontWeight="Bold" Foreground="White" FontSize="24">?? Künye</Span>
                            <LineBreak/>
                            <Run Text="Uygulama Adı: Püsü IPTV"/>
                            <LineBreak/>
                            <Run Text="Versiyon: 1"/>
                            <LineBreak/>
                            <Run Text="Yıl: 2026"/>
                            <LineBreak/>
                            <Run Text="İlham Kaynağı: Püskül (Sarı Sarman)"/>
                            <LineBreak/>
                            <Run Text="Teknoloji: .NET 6 / WPF / LibVLCSharp"/>
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
                <Button Grid.Row="2" Content="GERİ DÖN" HorizontalAlignment="Left" Padding="40,15" FontSize="18"
                        Style="{StaticResource GradientButtonStyle}" Click="BtnBackFromAbout_Click"/>
            </Grid>
        </Grid>
        
        <!-- How To Use Screen -->
        <Grid x:Name="HowToUseScreen" Visibility="Collapsed" Panel.ZIndex="200">
            <Grid.RenderTransform>
                <TranslateTransform Y="0"/>
            </Grid.RenderTransform>
            <Grid.Background>
                <RadialGradientBrush Center="0.5,0.5" GradientOrigin="0.5,0.5" RadiusX="1" RadiusY="1">
                    <GradientStop Color="#00182E" Offset="0"/> <!-- Deep Blue -->
                    <GradientStop Color="#121212" Offset="1"/>
                </RadialGradientBrush>
            </Grid.Background>
            <Grid Margin="50">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,30">
                     <TextBlock Text="??" FontSize="40" Margin="0,0,15,0"/>
                     <TextBlock Text="Nasıl Kullanılır?" FontSize="36" FontWeight="Bold" Foreground="#00A8E8" VerticalAlignment="Center"/>
                </StackPanel>
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Keyboard Shortcuts -->
                        <Border Background="#1AFFFFFF" CornerRadius="12" Padding="20" Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="Klavye Kısayolları" FontSize="22" FontWeight="Bold" Foreground="#FF8C42" Margin="0,0,0,15"/>
                                
                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="KeyIcon"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0" Background="#33FFFFFF" CornerRadius="6" Padding="10,5" Margin="0,0,15,0">
                                        <TextBlock Text="Boşluk" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Grid.Column="1" Text="Oynat / Duraklat" VerticalAlignment="Center" FontSize="16" Foreground="#DDD"/>
                                </Grid>

                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="KeyIcon"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0" Background="#33FFFFFF" CornerRadius="6" Padding="10,5" Margin="0,0,15,0">
                                        <TextBlock Text="?? Yukarı / ?? Aşağı" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Grid.Column="1" Text="Kanal Değiştir (Önceki / Sonraki)" VerticalAlignment="Center" FontSize="16" Foreground="#DDD"/>
                                </Grid>

                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="KeyIcon"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0" Background="#33FFFFFF" CornerRadius="6" Padding="10,5" Margin="0,0,15,0">
                                        <TextBlock Text="?? Sağ / ?? Sol" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Grid.Column="1" Text="Ses Kontrolü (Aç / Kıs)" VerticalAlignment="Center" FontSize="16" Foreground="#DDD"/>
                                </Grid>

                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="KeyIcon"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0" Background="#33FFFFFF" CornerRadius="6" Padding="10,5" Margin="0,0,15,0">
                                        <TextBlock Text="M Tuşu" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Grid.Column="1" Text="Sesi Tamamen Kapat (Mute)" VerticalAlignment="Center" FontSize="16" Foreground="#DDD"/>
                                </Grid>

                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="KeyIcon"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0" Background="#33FFFFFF" CornerRadius="6" Padding="10,5" Margin="0,0,15,0">
                                        <TextBlock Text="F11" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Grid.Column="1" Text="Tam Ekran Modu" VerticalAlignment="Center" FontSize="16" Foreground="#DDD"/>
                                </Grid>

                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="KeyIcon"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0" Background="#33FFFFFF" CornerRadius="6" Padding="10,5" Margin="0,0,15,0">
                                        <TextBlock Text="K Tuşu" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Grid.Column="1" Text="Kaydı Başlat / Durdur" VerticalAlignment="Center" FontSize="16" Foreground="#DDD"/>
                                </Grid>

                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="KeyIcon"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Border Grid.Column="0" Background="#33FFFFFF" CornerRadius="6" Padding="10,5" Margin="0,0,15,0">
                                        <TextBlock Text="G Tuşu" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Grid.Column="1" Text="Ekran Görüntüsü Al" VerticalAlignment="Center" FontSize="16" Foreground="#DDD"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
                <Button Grid.Row="2" Content="ANLAŞILDI" HorizontalAlignment="Left" Padding="40,15" FontSize="18"
                        Style="{StaticResource GradientButtonStyle}" Click="BtnCloseHowToUse_Click"/>
            </Grid>
        </Grid>
        <!-- Custom Dialog Popup -->
        <Border x:Name="CustomDialogOverlay" Background="#CC000000" Visibility="Collapsed" Panel.ZIndex="1000">
            <Border Background="#1E1E2E" CornerRadius="16" MaxWidth="500" Padding="40" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect Color="#FF8C42" BlurRadius="30" ShadowDepth="0" Opacity="0.4"/>
                </Border.Effect>
                <StackPanel>
                    <!-- Icon -->
                    <Grid Margin="0,0,0,20">
                        <TextBlock x:Name="DialogIcon" Text="??" FontSize="64" HorizontalAlignment="Center"/>
                        <Image x:Name="DialogImage" Source="Resources/Images/puskul_head.png" Width="120" Height="120" HorizontalAlignment="Center" Visibility="Collapsed" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
                    </Grid>
                    <!-- Title -->
                    <TextBlock x:Name="DialogTitle" Text="Püskül'ün Favorileri" FontSize="24" FontWeight="Bold" 
                               Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                    <!-- Message -->
                    <TextBlock x:Name="DialogMessage" Text="Püskül henüz favori kanalını bulamadı!&#x0a;&#x0a;İzlemeye başla, Püskül seni tanısın." 
                               FontSize="16" Foreground="#CCCCCC" TextWrapping="Wrap" TextAlignment="Center" Margin="0,0,0,30"/>
                    <!-- OK Button -->
                    <Button Content="TAMAM" Click="CloseCustomDialog_Click" Height="50" 
                            Style="{StaticResource GradientButtonStyle}" />
                </StackPanel>
            </Border>
        </Border>
    </Grid>
</Window>

